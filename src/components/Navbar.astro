<div
	class="fixed z-40 bg-white rounded-full top-4 right-4 shadow-md p-3 cursor-pointer"
	id="hamburger-btn"
>
	<svg
		xmlns="http://www.w3.org/2000/svg"
		x="0px"
		y="0px"
		width="30"
		height="30"
		viewBox="0 0 50 50"
		fill="#774F4F"
	>
		<path
			d="M 5 8 A 2.0002 2.0002 0 1 0 5 12 L 45 12 A 2.0002 2.0002 0 1 0 45 8 L 5 8 z M 5 23 A 2.0002 2.0002 0 1 0 5 27 L 45 27 A 2.0002 2.0002 0 1 0 45 23 L 5 23 z M 5 38 A 2.0002 2.0002 0 1 0 5 42 L 45 42 A 2.0002 2.0002 0 1 0 45 38 L 5 38 z"
		></path>
	</svg>
</div>

<!-- Full Screen Navbar -->
<div
	class="fixed inset-0 w-screen h-screen bg-[#774F4F] z-50 flex flex-col opacity-0 invisible"
	id="fullscreen-nav"
>
	<!-- Contenedor central: logo + men√∫ -->
	<div class="flex flex-1 w-full px-6 md:px-12 items-center justify-center">
		<div
			class="flex flex-col md:flex-row items-center md:items-start gap-10 md:gap-20"
		>
			<!-- Logo -->
			<div class="flex flex-col items-center md:items-start">
				<img
					src="/assets/logos/logo-rumbo-min.png"
					alt="Logo"
					class="w-[clamp(150px,20vw,400px)] mb-6"
				/>
			</div>

			<!-- Men√∫ + contacto -->
			<div
				class="flex flex-col items-center md:items-start text-center md:text-left"
			>
				<!-- Links -->
				<a
					href="#home"
					class="nav-item text-xl md:text-2xl lg:text-[3vw] font-bold text-[#E2D9D5] my-3 cursor-pointer hover:text-gray-200 opacity-0 translate-y-12 transition-colors duration-300 font-archive"
					>INICIO</a
				>
				<a
					href="#photography"
					class="nav-item text-xl md:text-2xl lg:text-[3vw] font-bold text-[#E2D9D5] my-3 cursor-pointer hover:text-gray-200 opacity-0 translate-y-12 transition-colors duration-300 font-archive"
					>FOTOGRAF√çA Y VIDEO</a
				>
				<a
					href="#our-services"
					class="nav-item text-xl md:text-2xl lg:text-[3vw] font-bold text-[#E2D9D5] my-3 cursor-pointer hover:text-gray-200 opacity-0 translate-y-12 transition-colors duration-300 font-archive"
					>SERVICIOS</a
				>
				<a
					href="#design"
					class="nav-item text-xl md:text-2xl lg:text-[3vw] font-bold text-[#E2D9D5] my-3 cursor-pointer hover:text-gray-200 opacity-0 translate-y-12 transition-colors duration-300 font-archive"
					>DISE√ëO</a
				>
				<a
					href="#cm"
					class="nav-item text-xl md:text-2xl lg:text-[3vw] font-bold text-[#E2D9D5] my-3 cursor-pointer hover:text-gray-200 opacity-0 translate-y-12 transition-colors duration-300 font-archive"
					>CONTENT MANAGEMENT</a
				>
				<a
					href="#about-us"
					class="nav-item text-xl md:text-2xl lg:text-[3vw] font-bold text-[#E2D9D5] my-3 cursor-pointer hover:text-gray-200 opacity-0 translate-y-12 transition-colors duration-300 font-archive"
					>SOBRE NOSOTROS</a
				>
				<a
					href="#contact-us"
					class="nav-item text-xl md:text-2xl lg:text-[3vw] font-bold text-[#E2D9D5] my-3 cursor-pointer hover:text-gray-200 opacity-0 translate-y-12 transition-colors duration-300 font-archive"
					>CONTACTO</a
				>

				<!-- Contacto -->
				<div class="mt-8 md:mt-10 text-[#E2D9D5] flex flex-col gap-4">
					<div class="flex items-center gap-3">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="24"
							height="24"
							fill="#E0D7D3"
							viewBox="0 0 30 30"
						>
							<path
								d="M 9.9980469 3 C 6.1390469 3 3 6.1419531 3 10.001953 L 3 20.001953 C 3 23.860953 6.1419531 27 10.001953 27 L 20.001953 27 C 23.860953 27 27 23.858047 27 19.998047 L 27 9.9980469 C 27 6.1390469 23.858047 3 19.998047 3 L 9.9980469 3 z M 22 7 C 22.552 7 23 7.448 23 8 C 23 8.552 22.552 9 22 9 C 21.448 9 21 8.552 21 8 C 21 7.448 21.448 7 22 7 z M 15 9 C 18.309 9 21 11.691 21 15 C 21 18.309 18.309 21 15 21 C 11.691 21 9 18.309 9 15 C 9 11.691 11.691 9 15 9 z M 15 11 A 4 4 0 0 0 11 15 A 4 4 0 0 0 15 19 A 4 4 0 0 0 19 15 A 4 4 0 0 0 15 11 z"
							></path>
						</svg>
						<span
							class="text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl font-semibold"
							>Instagram:</span
						>
						<a
							href="https://www.instagram.com/rumbo.comunicacion?igsh=NmFyc2t1YnpwcW01"
							target="_blank"
							rel="noopener noreferrer"
							class="text-sm sm:text-base md:text-lg hover:opacity-75 transition-opacity break-all font-normal"
							>@rumbo.comunicaci√≥n</a
						>
					</div>
					<div class="flex items-center gap-3">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							x="0px"
							y="0px"
							width="30"
							height="30"
							viewBox="0 0 64 64"
							fill="#E0D7D3"
						>
							<path
								d="M47 34.837V52h7.533C56.448 52 58 50.448 58 48.533V29.486L47 34.837zM47 32l11-7.333v-5.426c0-1.914-.812-3.781-2.325-4.953-2.336-1.809-5.515-1.673-7.665.151L47 15.232V32zM19.814 33.822L32 41 44.349 33.726 43.443 18.023 32 27 20.718 18.149zM17.153 32.102v-16.75L15.99 14.44c-2.15-1.823-5.329-1.961-7.664-.151C6.812 15.46 6 17.328 6 19.243v5.424L17.153 32.102zM6 29.486v19.047C6 50.448 7.552 52 9.467 52H17V34.837L6 29.486z"
							></path>
						</svg>
						<span
							class="text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl font-semibold"
							>Email:</span
						>
						<a
							href="mailto:rumbo@gmail.com"
							class="text-sm sm:text-base md:text-lg hover:opacity-75 transition-opacity font-normal"
							>rumbocomunicacion1@gmail.com</a
						>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Bot√≥n de cerrar -->
	<div
		class="absolute top-5 right-5 w-12 h-12 bg-white rounded-full flex items-center justify-center cursor-pointer opacity-0 transform rotate-45"
		id="close-btn"
	>
		<svg
			xmlns="http://www.w3.org/2000/svg"
			viewBox="0 0 24 24"
			class="w-7 h-7 fill-[#774F4F]"
		>
			<path
				d="M18 6L6 18M6 6l12 12"
				stroke="currentColor"
				stroke-width="2"
				stroke-linecap="round"></path>
		</svg>
	</div>
</div>

<script>
	import gsap from "gsap";
	import { SplitText } from "gsap/SplitText";

	gsap.registerPlugin(SplitText);

	// Tipado de los elementos del DOM
	const hamburgerBtn = document.getElementById(
		"hamburger-btn",
	) as HTMLButtonElement | null;
	const fullscreenNav = document.getElementById(
		"fullscreen-nav",
	) as HTMLElement | null;
	const closeBtn = document.getElementById(
		"close-btn",
	) as HTMLButtonElement | null;
	const navItems = document.querySelectorAll<HTMLElement>(".nav-item");

	let isNavOpen = false;

	function openNav(): void {
		if (isNavOpen) return;
		isNavOpen = true;

		// üö´ Bloquear scroll en toda la p√°gina
		document.body.classList.add("overflow-hidden");

		const splitTexts: SplitText[] = [];
		navItems.forEach((item) => {
			splitTexts.push(new SplitText(item, { type: "chars" }));
		});

		const tl = gsap.timeline();

		if (fullscreenNav && closeBtn) {
			tl.set(fullscreenNav, { visibility: "visible" })
				.to(fullscreenNav, {
					opacity: 1,
					duration: 0.5,
					ease: "power2.out",
				})
				.to(
					closeBtn,
					{
						opacity: 1,
						rotation: 0,
						duration: 0.3,
						ease: "back.out(1.7)",
					},
					"-=0.3",
				);
		}

		splitTexts.forEach((splitText, index) => {
			const item = navItems[index];
			tl.to(
				item,
				{
					opacity: 1,
					y: 0,
					duration: 0.1,
				},
				"-=0.1",
			).from(
				splitText.chars,
				{
					opacity: 0,
					y: 50,
					rotationX: -90,
					stagger: 0.02,
					duration: 0.2,
					ease: "back.out(1.7)",
				},
				"-=0.1",
			);
		});
	}

	function closeNav(): void {
		if (!isNavOpen) return;
		isNavOpen = false;

		// ‚úÖ Restaurar scroll
		document.body.classList.remove("overflow-hidden");

		const tl = gsap.timeline();
		tl.to(navItems, {
			opacity: 0,
			y: 50,
			duration: 0.3,
			stagger: 0.05,
			ease: "power2.in",
		});

		if (closeBtn) {
			tl.to(
				closeBtn,
				{
					opacity: 0,
					rotation: 45,
					duration: 0.2,
				},
				"-=0.2",
			);
		}

		if (fullscreenNav) {
			tl.to(
				fullscreenNav,
				{
					opacity: 0,
					duration: 0.4,
					ease: "power2.in",
				},
				"-=0.1",
			).set(fullscreenNav, { visibility: "hidden" });
		}
	}

	// Event listeners
	hamburgerBtn?.addEventListener("click", openNav);
	closeBtn?.addEventListener("click", closeNav);

	// Cerrar con Escape
	document.addEventListener("keydown", (e: KeyboardEvent) => {
		if (e.key === "Escape" && isNavOpen) {
			closeNav();
		}
	});

	// Cerrar al hacer click en un item del men√∫
	navItems.forEach((item) => {
		item.addEventListener("click", () => {
			console.log(`Navegando a: ${item.textContent}`);
			closeNav();
		});
	});
</script>
